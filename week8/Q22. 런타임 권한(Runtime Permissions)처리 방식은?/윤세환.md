### 권한 선언 및 확인

- manifest파일에 사용하고자 하는 권한을 선언
- 앱 런타임시에는 권한이 필요한 기능과 상호작용하는 경우에만 해당 권한을 요청해야 함
- 권한을 요청하기 전 먼저 `ContextCompat.checkSelfPermission`을 사용하여 권한이 이미 부여되었는지 확인

### 권한 요청하기

- `ActivityResultLauncher` API 를 사용하는 것을 권장
- compose의 경우에는, 각 composable에서 `rememberLauncherForActivityResult` 와 같은 메서드를 사용하여 처리 가능

```kotlin
@Composable
fun CameraScreen() {
	// 예시
	var permissionGranted by remember { mutableStateOf(false) }
	val context = LocalContext.current
	val cameraPermissionLauncher = rememberLauncherForActivityResult(
    contract = ActivityResultContracts.RequestPermission(),
    onResult = { isGranted ->
      if (!isGranted) {
        Toast.makeText(context, context.getString(R.string.permission_description_camera), Toast.LENGTH_SHORT).show()
        onBackPress()
      }
      permissionGranted = isGranted
    }
	)
	
	LaunchedEffect(Unit) {
    cameraPermissionLauncher.launch(Manifest.permission.CAMERA)
  }
  
  // 나머지 UI 및 로직 부분
}
```

### 권한 요청 근거 제공하기

- 경우에 따라 시스템은 shouldShowRequestPermissionRetionale()을 사용하여 권한을 요청하기 전 해당 기능을 사용하기 위해 권한이 필요한 근거를 표시할 것을 권장
- 만약 해당 값이 true인 경우 해당 권한이 필요한 이유를 UI로 표시해야 함
- 단, shouldShowRequestPermissionRaionale()은 사용자가 “다시 묻지 않음”과 같이 권한을 영구적으로 거부했을 때 뿐만 아니라 아예 권한 요청이 한 번도 이루어지지 않은 상황에서도 flase를 반환한다는 점은 유의

### 권한 거부 처리하기

- 사용자가 권한을 여러 번 거부할 경우, 안드로이드는 이를 영구적인 권한 거부로 판단하여 해당 권한을 다시는 요청할 수 없게 된다.
- 이 경우 앱은 사용자에게 권한 거부로 인해 기능이 제한됨을 안내하고 필요한 경우 시스템 설정으로 이동하도록 하여 사용자가 직접 해당 권한을 허용하도록 처리해야 함

### 위치 권한 처리하기

- 위치 권한은 foreground 및 background 접근으로 분류
- foreground에서는 `ACCESS_FINE_LOCATION` 또는 `ACCESS_COARSE_LOCATION` 이 필요
- background에서는 `ACCESS_FINE_LOCATION` 또는 `ACCESS_COARSE_LOCATION` 외에 추가적으로 `ACCESS_BACKGROUND_LOCATION` 권한이 필요
- Android 10 이상부터는 백그라운드 위치 권한을 요청하는 앱은 먼저 foreground 위치 접근 권한을 요청한 다음 별도로 백그라운드 권한을 요청해야 함

### 일회성 권한

- Android 11 이후부터 위치, 카메라, 마이크에 대해 일회성 권한을 도입하여, 사용자는 임시적으로 접근 권한을 허용할 수 있다. 이 경우 앱이 종료되는 시점에서 해당 권한은 사라진다.

### Q. 안드로이드의 런타임 권한 시스템은 사용자 개인 정보를 어떻게 보호하며, 민감한 권한을 요청하기 전에 앱은 어떤 시나리오를 고려해야 하나요?

- 런타임 권한 시스템 덕분에 악생 앱이 사용자의 인지 없이 카메라, 외부 저장소와 같은 개인 정보와 관련된 부분에 접근하는 것을 막을 수 있다.
- 민감한 권한을 요청할 경우, 사용자는 먼저 해당 권한이 이 앱의 어떤 기능에, 어떻게 사용되는 것인지를 UI적으로 표시한 후 사용자에게 권한을 요청해야 한다.